# Сценарии общения с Алисой (навык Холз)

Документ для тестирования, документации и доработки диалогов навыка HAULZ в Яндексе Алисе.

---

## 1. Первый запуск и авторизация

| Шаг | Пользователь | Алиса |
|-----|--------------|-------|
| 1.1 | «Запусти навык Холз» | Приветствие и предложение ввести код авторизации из мини‑приложения. |
| 1.2 | (без кода) «Какие перевозки в пути?» | «Авторизуйтесь, пожалуйста. Введите код авторизации из мини‑приложения Холз.» |
| 1.3 | Пользователь открывает мини‑приложение → Профиль → Голосовые помощники → Получить код для Алисы. | — |
| 1.4 | Называет код, например «**123456**» | «Вы авторизованы под компанией [Название компании]. Чем я могу вам помочь?» |
| 1.5 | Неверный или истёкший код «999999» | «Код не найден или истек. Получите новый код в мини‑приложении.» |

**Варианты фраз пользователя для кода:** «Код 123456», «123456», «Введи код 123456».

---

## 2. Перевозки в пути

| Шаг | Пользователь | Алиса |
|-----|--------------|-------|
| 2.1 | «Какие перевозки в пути?» / «Что в пути?» / «Перевозки в дороге» | Краткий ответ: «В пути N перевозок: номер X, номер Y, … Хотите подробнее?» или «Сейчас нет перевозок в пути.» |
| 2.2 | «Да» / «Подробнее» / «Хочу» | Подробный ответ по каждой перевозке: номер, статус, сумма, маршрут, оплата. |
| 2.3 | (без предварительного запроса) «Подробнее» | Может интерпретироваться как ответ на предыдущий вопрос (если в сессии был запрос «в пути»). |

**Синонимы запроса:** «перевозки в пути», «в пути», «в дороге», «что сейчас в пути».

---

## 3. Счета на оплату / требующие оплаты

| Шаг | Пользователь | Алиса |
|-----|--------------|-------|
| 3.1 | «Какие счета на оплату?» / «Что требует оплаты?» / «Неоплаченные перевозки» | Краткий ответ: «Требуют оплаты N перевозок: номер X, номер Y, … Хотите подробнее?» или «Перевозок, требующих оплаты, нет.» |
| 3.2 | «Да» / «Подробнее» | Подробности по каждой перевозке: номер, статус, сумма, маршрут, оплата. |

**Синонимы:** «счета», «счёт», «оплата», «что надо оплатить», «задолженность».

---

## 4. Отвязка компании (голосом)

| Шаг | Пользователь | Алиса |
|-----|--------------|-------|
| 4.1 | «Отвяжи компанию» / «Отвяжи заказчика» / «Отвяжи» | Подтверждение отвязки и предложение при необходимости снова получить код в мини‑приложении. |
| 4.2 | После отвязки: «Какие перевозки в пути?» | «Авторизуйтесь, пожалуйста. Введите код авторизации из мини‑приложения Холз.» |

*Примечание: если команда «отвяжи компанию» в навыке Алисы ещё не реализована, этот сценарий — кандидат на доработку.*

---

## 5. Проверка навыка (каталог Алисы)

| Шаг | Пользователь | Алиса |
|-----|--------------|-------|
| 5.1 | «Код проверки» / «Проверка навыка» | «Код проверки: [код из ALICE_VERIFICATION_CODE].» |

---

## 6. Прочие вопросы (через чат HAULZ)

Любой другой запрос передаётся в AI-чат с контекстом компании. Примеры:

| Пользователь | Ожидаемое поведение |
|--------------|---------------------|
| «Какой у меня активный заказчик?» | Ответ с названием компании из привязки. |
| «Контакты Холз» | Адреса, телефон, email, сайт. |
| «Статус перевозки номер 12345» | Поиск по контексту перевозок или предложение уточнить номер. |
| «Когда прибудет груз 12345?» | Ответ на основе данных по перевозке, если есть. |

При таймауте или ошибке бэкенда Алиса говорит: «Запрос обрабатывается дольше обычного. Повторите запрос через несколько секунд.»

---

## 7. Сценарии для расширения (идеи)

- **Сводка за день/неделю:** «Сколько перевозок за сегодня?», «Что пришло на этой неделе?»
- **Напоминание об оплате:** «Напомни про неоплаченные счета завтра.»
- **Выбор компании:** при нескольких компаниях в мини‑приложении — «Работай от имени компании X» (если будет мультиаккаунт в навыке).
- **Отвязка голосом:** «Отвяжи компанию» — очистка привязки в навыке (см. блок 4).
- **Краткий статус:** «Одна фраза: что у меня в работе?» — один ответ: в пути N, к оплате M.

---

## 8. Тест-кейсы (чек-лист)

- [ ] Запуск навыка без кода → просьба авторизоваться.
- [ ] Ввод верного кода → приветствие с названием компании.
- [ ] Ввод неверного/старого кода → сообщение «код не найден или истек».
- [ ] «Перевозки в пути» → краткий список или «нет перевозок».
- [ ] После «в пути» → «Подробнее» → полный список.
- [ ] «Что на оплату?» / «Счета на оплату» → краткий список или «нет».
- [ ] После «счета» → «Подробнее» → детали по перевозкам.
- [ ] «Код проверки» → вывод кода проверки навыка.
- [ ] Вопрос «Контакты Холз» → контакты из базы знаний.
- [ ] Таймаут 1С/чата → «Повторите запрос через несколько секунд».

---

*Файл: `docs/alice-scenarios.md`. Обновлять при изменении логики в `api/alice.ts`.*
